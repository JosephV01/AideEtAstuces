<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Démonstration - Déplacer une Bulle sur le bureau - MyCustomDesk</title>
    <link rel="stylesheet" href="HelpAndTips.css">
    <link rel="stylesheet" href="demo-elements.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: var(--background-white);
            font-family: 'Segoe UI Variable', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .demo-container {
            background: var(--background-white);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px var(--shadow-light);
            text-align: center;
        }

        .demo-canvas-container {
            background: #2D2D2D;
            border: 2px solid #555555;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            display: inline-block;
        }

        .movable-bubble {
            
            top: 100px; 
            transition: none; 
        }

        .movable-label {
            
            top: -25px; 
            left: 100px; 
            transform: translateX(-50%);
            z-index: 1000;
        }

        .movable-resize-handle {
            
            left: auto !important;
            top: auto !important;
            right: -5px;
            bottom: -5px;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .mouse-cursor {
            z-index: 1500 !important;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1 class="demo-title">Démonstration - Déplacer une Bulle sur le bureau</h1>
            <p class="demo-description">
                Cette démonstration montre comment déplacer une Bulle sur votre bureau. Maintenez le clic gauche sur son étiquette tout en déplaçant la souris sur votre écran. Relâchez le clic une fois la Bulle correctement positionnée.
        
            </p>
        </div>

        <div class="speed-control">
            <label for="speedSlider">Vitesse de l'animation :</label>
            <input type="range" id="speedSlider" min="0.25" max="3" step="0.25" value="1" class="speed-slider">
            <span id="speedValue">1x</span>
            <button id="pauseButton" class="pause-button">Pause</button>
            <button class="back-button" onclick="window.close()">Fermer</button>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="progress-text" id="progressText">Préparation de la démonstration...</div>
        </div>
        
        <div class="demo-canvas-container">
            <div class="demo-canvas large">
                
                <div class="dynamic-border movable-bubble">
                    <div class="resize-handle movable-resize-handle"></div>
                    
                    <div class="label-border movable-label">
                        <span class="label-text">Déplacer la Bulle</span>
                    </div>
                </div>

                <div class="mouse-cursor"></div>

                <div class="mouse-zero-click large"></div>

                <div class="mouse-left-click large"></div>

            </div>
        </div>

    </div>

    <script>
        
        let animationPhase = 0;
        let animationTimer;
        let animationSpeed = 1;
        let isPaused = false;

        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');

        const totalAnimationFrames = 186; 
        let baseInterval = 30; 
        const CURSOR_SPEED_PX_PER_FRAME = 9; 

        const mouseCursor = document.querySelector('.mouse-cursor');
        const mouseZeroClick = document.querySelector('.mouse-zero-click');
        const mouseLeftClick = document.querySelector('.mouse-left-click');
        const movableBubble = document.querySelector('.dynamic-border');
        const movableLabel = document.querySelector('.label-border');
        const movableResizeHandle = document.querySelector('.resize-handle');

        function startAnimation() {
            
            updateProgress(0, totalAnimationFrames);
            
            const currentInterval = Math.round(baseInterval / animationSpeed);
            animationTimer = setInterval(() => {
                
                if (isPaused) {
                    return;
                }
                
                animationPhase++;

                if (animationPhase <= 30) {
                    const progress = animationPhase / 30;
                    const startX = 143, startY = 92;
                    const endX = 150, endY = 75; 
                    mouseCursor.style.left = (startX + (endX - startX) * progress) + 'px';
                    mouseCursor.style.top = (startY + (endY - startY) * progress) + 'px';
                }
                
                else if (animationPhase <= 38) {
                    const clickPhase = animationPhase - 30;

                    if (clickPhase >= 3) {
                        mouseZeroClick.style.visibility = 'hidden';
                        mouseLeftClick.style.visibility = 'visible';
                    }
                }
                
                else if (animationPhase <= 78) {
                    const moveProgress = (animationPhase - 38) / 40;

                    const bubbleStartX = 50, bubbleEndX = 200;
                    const bubbleX = bubbleStartX + (bubbleEndX - bubbleStartX) * moveProgress;
                    movableBubble.style.left = bubbleX + 'px';
                    movableBubble.style.top = '100px';

                    const cursorX = bubbleX + 100; 
                    const cursorY = 75; 
                    mouseCursor.style.left = cursorX + 'px';
                    mouseCursor.style.top = cursorY + 'px';
                    
                }
                
                else if (animationPhase <= 88) {

                    mouseZeroClick.style.visibility = 'visible';
                    mouseLeftClick.style.visibility = 'hidden';
                }
                
                else if (animationPhase <= 108) {
                    
                }
                
                else if (animationPhase <= 116) {
                    const clickPhase = animationPhase - 108;

                    if (clickPhase >= 3) {
                        mouseZeroClick.style.visibility = 'hidden';
                        mouseLeftClick.style.visibility = 'visible';
                    }
                }
                
                else if (animationPhase <= 156) {
                    const moveProgress = (animationPhase - 116) / 40;

                    const bubbleStartX = 200, bubbleEndX = 50;
                    const bubbleX = bubbleStartX + (bubbleEndX - bubbleStartX) * moveProgress;
                    movableBubble.style.left = bubbleX + 'px';
                    movableBubble.style.top = '100px';

                    const cursorX = bubbleX + 100; 
                    const cursorY = 75; 
                    mouseCursor.style.left = cursorX + 'px';
                    mouseCursor.style.top = cursorY + 'px';
                    
                }
                
                else if (animationPhase <= 166) {

                    mouseZeroClick.style.visibility = 'visible';
                    mouseLeftClick.style.visibility = 'hidden';
                }
                
                else if (animationPhase <= 176) {
                    mouseCursor.style.opacity = '0';
                }
                
                else if (animationPhase <= 186) {
                    
                }
                
                else {
                    animationPhase = 0;
                    movableBubble.style.left = '50px';
                    movableBubble.style.top = '100px';
                    mouseCursor.style.left = '143px';
                    mouseCursor.style.top = '92px';
                    mouseCursor.style.opacity = '1';

                    mouseZeroClick.style.visibility = 'visible';
                    mouseLeftClick.style.visibility = 'hidden';
                }

                updateProgress(animationPhase, totalAnimationFrames);
            }, currentInterval);
        }

        function restartAnimationWithNewSpeed() {
            if (animationTimer) {
                clearInterval(animationTimer);
            }
            startAnimation();
        }

        function updateProgress(phase, totalFrames) {
            
            const percentage = phase >= totalFrames ? 100 : (phase / totalFrames) * 100;
            progressBar.style.width = percentage + '%';

            const phase1End = 30; 
            const phase2End = 38; 
            const phase3End = 78; 
            const phase4End = 88; 
            const phase5End = 108; 
            const phase6End = 116; 
            const phase7End = 156; 
            const phase8End = 166; 
            const phase9End = 176; 
            const phase10End = 186; 

            if (phase <= phase1End) {
                progressText.textContent = 'Déplacement vers l\'étiquette...';
            } else if (phase <= phase2End) {
                progressText.textContent = 'Clic sur l\'étiquette...';
            } else if (phase <= phase3End) {
                progressText.textContent = 'Déplacement de la bulle...';
            } else if (phase <= phase4End) {
                progressText.textContent = 'Relâchement du clic...';
            } else if (phase <= phase5End) {
                progressText.textContent = 'Pause...';
            } else if (phase <= phase6End) {
                progressText.textContent = 'Deuxième clic...';
            } else if (phase <= phase7End) {
                progressText.textContent = 'Deuxième déplacement...';
            } else if (phase <= phase8End) {
                progressText.textContent = 'Deuxième relâchement...';
            } else if (phase <= phase9End) {
                progressText.textContent = 'Retour à la position initiale...';
            } else if (phase <= phase10End) {
                progressText.textContent = 'Animation terminée !';
            } else {
                progressText.textContent = 'Préparation du redémarrage...';
            }
        }

        function togglePause() {
            isPaused = !isPaused;
            const pauseButton = document.getElementById('pauseButton');
            
            if (isPaused) {
                pauseButton.textContent = 'Reprendre';
                pauseButton.classList.add('paused');
            } else {
                pauseButton.textContent = 'Pause';
                pauseButton.classList.remove('paused');
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const speedSlider = document.getElementById('speedSlider');
            const speedValue = document.getElementById('speedValue');
            const pauseButton = document.getElementById('pauseButton');
            
            if (speedSlider && speedValue) {
                speedSlider.addEventListener('input', function() {
                    animationSpeed = parseFloat(this.value);
                    speedValue.textContent = animationSpeed + 'x';
                    restartAnimationWithNewSpeed();
                });
                
                speedValue.textContent = animationSpeed + 'x';
            } else {
                console.warn('Éléments du slider non trouvés');
            }

            if (pauseButton) {
                pauseButton.addEventListener('click', togglePause);
            } else {
                console.warn('Bouton pause non trouvé');
            }

            setTimeout(startAnimation, 1000);
        });
    </script>
</body>
</html>
