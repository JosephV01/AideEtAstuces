<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saisir un titre - MyCustomDesk (Référence)</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI Variable', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .window {
            background: #ffffff;
            border: 2px solid #c0c0c0;
            border-radius: 15px;
            padding: 8px;
            width: 520px;
            max-width: 600px;
            min-width: 400px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .content {
            margin: 20px;
            display: grid;
            grid-template-rows: auto auto auto auto 1fr auto;
            gap: 15px;
        }

        .title {
            text-align: center;
            font-weight: bold;
            color: #000000;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .label {
            color: #000000;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .textbox {
            height: 30px;
            background: #f0f0f0;
            border: 1px solid #c0c0c0;
            color: #000000;
            font-size: 14px;
            padding: 0 5px;
            display: block;
            width: 100%;
        }

        .row { display: flex; flex-direction: column; }

        .combo {
            height: 30px;
            background: #f0f0f0;
            border: 1px solid #c0c0c0;
            color: #000000;
            font-size: 14px;
            padding: 0 5px;
            display: block;
            width: 100%;
        }

        .preview-box {
            background: #f0f0f0;
            border: 1px solid #c0c0c0;
            border-radius: 10px;
            padding: 10px;
        }

        .preview-label { color: #000000; font-size: 12px; margin-bottom: 10px; }

        .preview-surface {
            background: #f0f0f0;
            border: 2px solid #c0c0c0;
            border-radius: 10px;
            padding: 8px 4px;
            min-width: 120px;
            max-width: 300px;
            margin: 0 auto;
        }

        .preview-text {
            color: #000000;
            font-weight: 700;
            font-size: 16px;
            text-align: center;
            word-wrap: break-word;
            white-space: nowrap;
        }

        .actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .button {
            width: 100px;
            height: 30px;
            background: #f0f0f0;
            border: 1px solid #c0c0c0;
            border-radius: 4px;
            font-size: 12px;
            color: #000000;
            cursor: pointer;
        }

        .button:hover { background: #e0e0e0; }
    </style>
    <script>
        let currentText = '';

        function onInputChange() {
            const input = document.getElementById('titleInput');
            currentText = input.value || '';
            updatePreview();
        }

        function onComboChange() {
            const combo = document.getElementById('presetCombo');
            if (combo.selectedIndex > 0) {
                const value = combo.value;
                document.getElementById('titleInput').value = value;
                currentText = value;
                updatePreview();
            }
        }

        function handleKeyDown(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                onOk();
            }
        }

        function updatePreview() {
            const previewText = document.getElementById('previewText');
            const surface = document.getElementById('previewSurface');

            previewText.textContent = currentText || 'Titre';

            const minSize = 12;
            const baseDefault = 16;
            const maxSize = 20;
            let size = baseDefault;

            const length = currentText.length;
            if (!currentText) {
                size = 16;
                surface.style.width = '120px';
                previewText.style.whiteSpace = 'nowrap';
            } else if (length > 35) {
                size = Math.max(minSize, 16 - (length - 35) * 0.3);
                previewText.style.whiteSpace = 'normal';
            } else if (length > 25) {
                size = Math.max(minSize, 16 - (length - 25) * 0.2);
                previewText.style.whiteSpace = 'normal';
            } else if (length < 10) {
                size = Math.min(maxSize, 16 + (10 - length) * 0.2);
                previewText.style.whiteSpace = 'nowrap';
            } else {
                previewText.style.whiteSpace = 'nowrap';
            }

            previewText.style.fontSize = size + 'px';

            const temp = document.createElement('span');
            temp.style.fontFamily = getComputedStyle(previewText).fontFamily;
            temp.style.fontSize = size + 'px';
            temp.style.fontWeight = getComputedStyle(previewText).fontWeight;
            temp.style.visibility = 'hidden';
            temp.style.whiteSpace = 'nowrap';
            temp.textContent = currentText || 'Titre';
            document.body.appendChild(temp);
            const textWidth = temp.getBoundingClientRect().width;
            document.body.removeChild(temp);

            const padding = 16; // padding horizontal total simulé
            const safety = 3;
            const total = textWidth + padding + safety;
            const finalWidth = Math.max(80, Math.min(300, total));
            surface.style.width = finalWidth + 'px';
        }

        function onOk() {
            alert('OK: ' + (currentText || ''));
        }

        function onCancel() {
            alert('Annuler');
        }

        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('titleInput').addEventListener('input', onInputChange);
            document.getElementById('titleInput').addEventListener('keydown', handleKeyDown);
            document.getElementById('presetCombo').addEventListener('change', onComboChange);
            updatePreview();
        });
    </script>
    </head>
<body>
    <div class="window">
        <div class="content">
            <div class="title">Saisir un titre</div>

            <div class="row">
                <div class="label">Texte</div>
                <input id="titleInput" class="textbox" type="text" />
            </div>

            <div class="row">
                <div class="label">Titres prédéfinis</div>
                <select id="presetCombo" class="combo">
                    <option>Sélectionner un titre prédéfini</option>
                    <option>Projets</option>
                    <option>Documents</option>
                    <option>Finances</option>
                    <option>Personnel</option>
                    <option>Travail</option>
                    <option>Photos</option>
                    <option>Voyage</option>
                    <option>Maison</option>
                    <option>Urgent</option>
                    <option>Idées</option>
                </select>
            </div>

            <div class="preview-box">
                <div class="preview-label">Aperçu</div>
                <div id="previewSurface" class="preview-surface">
                    <div id="previewText" class="preview-text">Titre</div>
                </div>
            </div>

            <div class="actions">
                <button class="button" onclick="onCancel()">Annuler</button>
                <button class="button" onclick="onOk()">OK</button>
            </div>
        </div>
    </div>
</body>
</html>


